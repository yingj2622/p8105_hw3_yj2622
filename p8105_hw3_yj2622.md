Homework 3
================
Ying Jin
2020/10/6

## Problem 1

Load the dataset

``` r
data("instacart")
```

This dataset contains 1384617 rows and 15 columns.

Observations are the level of items in orders by user. There are user/
order variables – user ID, order ID, order day and order hour. There are
also item variables – name, aisle, department, and some numeric codes.

How many aisles, and which are most products from?

``` r
instacart %>% 
  count(aisle) %>%
  nrow()
```

    ## [1] 134

``` r
instacart %>% 
  count(aisle) %>%
  arrange(desc(n))
```

    ## # A tibble: 134 x 2
    ##    aisle                              n
    ##    <chr>                          <int>
    ##  1 fresh vegetables              150609
    ##  2 fresh fruits                  150473
    ##  3 packaged vegetables fruits     78493
    ##  4 yogurt                         55240
    ##  5 packaged cheese                41699
    ##  6 water seltzer sparkling water  36617
    ##  7 milk                           32644
    ##  8 chips pretzels                 31269
    ##  9 soy lactosefree                26240
    ## 10 bread                          23635
    ## # ... with 124 more rows

There are 134 aisles and most products come from fresh vegetables.

Let’s make a plot

``` r
instacart %>% 
  count(aisle) %>% 
  filter(n > 10000) %>% 
  mutate(
    aisle = factor(aisle),
    aisle = forcats::fct_reorder(aisle,n)
  ) %>% 
  ggplot(aes(x = aisle, y =n)) +
  geom_point() +
  theme(axis.text.x = element_text(angle = 90, vjust = .5,hjust = 1))
```

<img src="p8105_hw3_yj2622_files/figure-gfm/unnamed-chunk-3-1.png" width="90%" />

Three most popular items in three aisles

``` r
instacart %>% 
  filter(aisle %in% c("baking ingredients","dog food care","packaged vegetables fruits")) %>% 
  group_by(aisle) %>% 
  count(product_name) %>% 
  mutate(rank = min_rank(desc(n))) %>% 
  filter(rank < 4) %>% 
  arrange(aisle, rank) %>% 
  knitr::kable()
```

| aisle                      | product\_name                                 |    n | rank |
| :------------------------- | :-------------------------------------------- | ---: | ---: |
| baking ingredients         | Light Brown Sugar                             |  499 |    1 |
| baking ingredients         | Pure Baking Soda                              |  387 |    2 |
| baking ingredients         | Cane Sugar                                    |  336 |    3 |
| dog food care              | Snack Sticks Chicken & Rice Recipe Dog Treats |   30 |    1 |
| dog food care              | Organix Chicken & Brown Rice Recipe           |   28 |    2 |
| dog food care              | Small Dog Biscuits                            |   26 |    3 |
| packaged vegetables fruits | Organic Baby Spinach                          | 9784 |    1 |
| packaged vegetables fruits | Organic Raspberries                           | 5546 |    2 |
| packaged vegetables fruits | Organic Blueberries                           | 4966 |    3 |

Apples vs. Ice Cream

``` r
instacart %>% 
  filter(product_name %in% c("Pink Lady Apples","Coffee Ice Cream")) %>% 
  group_by(product_name,order_dow) %>% 
  summarise(
    mean_hour = mean(order_hour_of_day)
  ) %>% 
  pivot_wider(
    names_from = order_dow,
    values_from = mean_hour
  ) %>% 
  knitr::kable()
```

    ## `summarise()` regrouping output by 'product_name' (override with `.groups` argument)

| product\_name    |        0 |        1 |        2 |        3 |        4 |        5 |        6 |
| :--------------- | -------: | -------: | -------: | -------: | -------: | -------: | -------: |
| Coffee Ice Cream | 13.77419 | 14.31579 | 15.38095 | 15.31818 | 15.21739 | 12.26316 | 13.83333 |
| Pink Lady Apples | 13.44118 | 11.36000 | 11.70213 | 14.25000 | 11.55172 | 12.78431 | 11.93750 |

## Problem 2

First, load the accelerometer dataset and tidy it.

``` r
accel_df = read_csv("./data/accel_data.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    cols = starts_with("activity_"),
    names_to = "observation",
    values_to = "n_activ"
  ) %>% 
  mutate(
    weekday_vs_weekend = case_when(
      day %in% c("Monday","Tuesday","Wednesday","Thursday","Friday")~"weekday",
      day %in% c("Saturday","Sunday")~"weekend"
    )
  )
```

The steps I took to wrangle the dataset include:

  - clean the column names;

  - tidy the dataset with `pivot_longer`;

  - create a new column named `weekday_vs_weekend` to indicate whether a
    certain day is a weekday or a weekend.

The resulting dataset contains information about everyday “activity
counts” in each commonly one-minute intervals of a 63 year-old male
diagnosed with CHF. And the time range is five weeks.

  - It contains 50400 rows and 6 variables.

  - The dataset provides information on “activity counts” of the man in
    days in five weeks. The counting starts at the midnight of each day
    and “activity counts” in each observations in each days are given.
    Also, information about which week a certain day belongs to, day of
    the week and whether that day is a weekday or weekend can be
    obtained.

Then I aggregate accross minutes to create a total activity variable for
each day and create a table.

``` r
accel_df %>% 
  group_by(day_id) %>% 
  summarise(
    total_activ = sum(n_activ)
      ) %>% 
  knitr::kable()
```

    ## `summarise()` ungrouping output (override with `.groups` argument)

| day\_id | total\_activ |
| ------: | -----------: |
|       1 |    480542.62 |
|       2 |     78828.07 |
|       3 |    376254.00 |
|       4 |    631105.00 |
|       5 |    355923.64 |
|       6 |    307094.24 |
|       7 |    340115.01 |
|       8 |    568839.00 |
|       9 |    295431.00 |
|      10 |    607175.00 |
|      11 |    422018.00 |
|      12 |    474048.00 |
|      13 |    423245.00 |
|      14 |    440962.00 |
|      15 |    467420.00 |
|      16 |    685910.00 |
|      17 |    382928.00 |
|      18 |    467052.00 |
|      19 |    371230.00 |
|      20 |    381507.00 |
|      21 |    468869.00 |
|      22 |    154049.00 |
|      23 |    409450.00 |
|      24 |      1440.00 |
|      25 |    260617.00 |
|      26 |    340291.00 |
|      27 |    319568.00 |
|      28 |    434460.00 |
|      29 |    620860.00 |
|      30 |    389080.00 |
|      31 |      1440.00 |
|      32 |    138421.00 |
|      33 |    549658.00 |
|      34 |    367824.00 |
|      35 |    445366.00 |
